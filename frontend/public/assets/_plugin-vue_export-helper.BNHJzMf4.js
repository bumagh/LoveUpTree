import{A as t,a as e,B as r,C as s,D as o}from"./index-Cg44Emc2.js";const a=(r,s={})=>new Promise((o,a)=>{const{method:n="GET",data:c={},header:i={}}=s;t({url:`/api${r}`,method:n,data:c,header:{"Content-Type":"application/json",...i},success:t=>{t.statusCode>=200&&t.statusCode<300?o(t.data):(e({title:t.data.message||"请求失败",icon:"none",duration:2e3}),a(t.data))},fail:t=>{console.error("请求失败:",t),e({title:"网络异常，请稍后重试",icon:"none",duration:2e3}),a(t)}})}),n={register:(t,e)=>a("/auth/register",{method:"POST",data:{username:t,password:e}}),login:(t,e)=>a("/auth/login",{method:"POST",data:{username:t,password:e}}),getTasks(t,e="",r=""){const s={user_id:t};e&&(s.status=e),r&&(s.category=r);const o=Object.keys(s).map(t=>`${t}=${encodeURIComponent(s[t])}`).join("&");return a(`/tasks?${o}`)},createTask:t=>a("/tasks",{method:"POST",data:t}),updateTask:(t,e)=>a(`/tasks/${t}`,{method:"PUT",data:e}),deleteTask:(t,e)=>a(`/tasks/${t}?user_id=${e}`,{method:"DELETE"}),getTaskStats:t=>a(`/tasks/stats?user_id=${t}`),getPoints:t=>a(`/points?user_id=${t}`),completeTask:(t,e)=>a("/points",{method:"POST",data:{user_id:t,task_id:e}}),getFruits:t=>a(`/fruits?user_id=${t}`),unlockFruit:(t,e)=>a(`/fruits/${t}/unlock`,{method:"PUT",data:{user_id:e}}),checkStatus:()=>a("/status")},c="lovers_token",i="lovers_user",u="lovers_points",d={setToken(t){try{o(c,t)}catch(e){console.error("保存Token失败:",e)}},getToken(){try{return s(c)||""}catch(t){return console.error("获取Token失败:",t),""}},removeToken(){try{r(c)}catch(t){console.error("删除Token失败:",t)}},setUser(t){try{o(i,JSON.stringify(t))}catch(e){console.error("保存用户信息失败:",e)}},getUser(){try{const t=s(i);return t?JSON.parse(t):null}catch(t){return console.error("获取用户信息失败:",t),null}},removeUser(){try{r(i)}catch(t){console.error("删除用户信息失败:",t)}},setPoints(t){try{o(u,t)}catch(e){console.error("保存情力值失败:",e)}},getPoints(){try{return s(u)||0}catch(t){return console.error("获取情力值失败:",t),0}},updatePoints(t){this.setPoints(t);const e=this.getUser();e&&(e.points=t,this.setUser(e))},isLoggedIn(){const t=this.getToken(),e=this.getUser();return!(!t||!e)},clear(){try{this.removeToken(),this.removeUser(),r(u)}catch(t){console.error("清空存储失败:",t)}},setItem(t,e){try{const r="object"==typeof e?JSON.stringify(e):e;o(t,r)}catch(r){console.error(`保存${t}失败:`,r)}},getItem(t){try{const e=s(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}}catch(e){return console.error(`获取${t}失败:`,e),null}},removeItem(t){try{r(t)}catch(e){console.error(`删除${t}失败:`,e)}}},l=(t,e)=>{const r=t.__vccOpts||t;for(const[s,o]of e)r[s]=o;return r};export{l as _,n as a,d as s};
